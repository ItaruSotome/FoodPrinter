==========================================================================
manual.exe
コマンドライン入力による3Dフードプリンター制御用プログラム
Version 1. 0. 0  (2025/1/9)
==========================================================================
◆内容
東京大学大学院農学生命科学研究科生物プロセス工学研究室にて試作した3Dフードプリンターをコマンドラインから制御するためのプログラムです。
3Dフードプリンターは制御用I/Oボードとして、Y2Corporation製PMC-S4シリーズを搭載したものが対象となります。
別添のGコードによるプリンター制御ソフトウェア<bpe3dfp.exe>にて印刷を行う前の準備として、プリンターヘッドと印刷ステージの位置調整に利用します。
プログラムはWindowsPC用であり、PMC-S4とUSBポートで接続したPC上で実行して使用します。

◆要件
OS: Windows10/11
I/Oボード: PMC-S4シリーズ (PMC-S4/16/32A-U(35V))など
https://www.y2c.co.jp/
 PMC-S4はボード上のスイッチでIDを0~Fの間で設定可能ですが、IDは0に設定してください。
 ボードのIDを変更する必要がある場合は、別添のソースファイルを編集してプログラムを再ビルドしてください。

◆インストール方法
実行ファイル<manual.exe>を実行可能なフォルダにコピーして使用します。
使用するPCにPMC-S4シリーズのドライバーをあらかじめPCにインストールする必要があります。
 PMC-S4を購入すると、Y2Corporationにドライバーソフトウェアを請求できます。

◆使用方法
3Dフードプリンターの電源を入れ、PCとUSBケーブルで接続します。
Windowsのコマンドプロンプトを開きます。
実行ファイルをコピーしたフォルダにカレントディレクトリを移動します。
 例) >cd c:\program files\bpe3dfp
実行ファイルを指定してプログラムを起動します。
 例) c:\program files\bpe3dfp>manual.exe

コマンドラインよりGコードを入力します。解釈するGコードはG0、G1、G92です。
G0 および G1で高速移動、補間移動を切り替えます。
G0では装置の最高速度で移動します。
G1ではFワードで移動速度を設定します。初期値ではF600 (600mm/min)に設定されています。
G92で現在地のディメンションを設定します。
ディメンションの単位はミリメートルです。
コードおよびワードは大文字で入力してください。

例）
印刷ヘッドを機械原点に移動した後、機械原点からX、Yそれぞれ10mm移動した場所を作業原点に設定
 G0 X-100 Y-100 ;(-100 mmで、X、Yそれぞれ必ず機械原点のリミットスイッチまで移動する)
 G0 X10 Y10 ;(機械原点からX、Yそれぞれ10 mm移動)
 G92 X0 Y0 ;(移動した点を作業原点に設定)

印刷ステージをエクストルーダノズルに接する高さまで移動して、作業原点に設定
 F120 ;(移動速度120 mm/minに設定)
 G1 Z-10 ;(ここでステージとノズルが接したとする)
 G92 Z0 ;(Z0地点を設定)

ノズルパージとリトラクション
 F2.5
 G1 E0.5 ;(ノズルバージ)
 G92 E0 ;(エクストルーダーの送り位置をリセット)
 G1 E-0.5; (リトラクション)

"Q"もしくは"q"を先頭に含む文字列を入力するとプログラムが終了します。

◆トラブルシューティング
次のエラーメッセージが表示された場合
"Failed to open PMC-S4/16/32A-U"
 I/Oボードを開くことができませんでした。下記について確認してください。
  ・プリンターの電源が入っているか
  ・USBケーブルが接続されているか
  ・I/OボードのIDが正しく設定されているか
  ・I/Oボードのドライバーが正しくインストールされているか

◆その他
このプログラムは無保証で提供されており、明示・黙示を問わず、いかなる保証も含まれておりません。特定の目的への適合性や、法的権利の侵害を行わないことの保証も含みません。 本ソフトウェアの使用に起因するデータ損失、業務停止、その他の損害について、開発者および関係者は一切責任を負いません。
連絡先: 五月女　格 (itarus@g.ecc.u-tokyo.ac.jp)