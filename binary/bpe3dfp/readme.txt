==========================================================================
bpe3dfp.exe
Gコードファイルによる3Dフードプリンター制御用プログラム
Version 1. 0. 0  (2025/1/9)
==========================================================================
◆内容
東京大学大学院農学生命科学研究科生物プロセス工学研究室にて試作した3Dフードプリンターを動作させるためのプログラムです。
3Dフードプリンターは制御用I/Oボードとして、Y2Corporation製PMC-S4シリーズを搭載したものが対象となります。
スライサーソフトウェアにて生成されたGコードを解釈し、PMC-S4へステッピングモーターを駆動するための制御信号を送信します。
現状ではG00、G01、G92にのみ対応しており、これ以外のGコードおよびMコード等はスキップします。
UltiMaker Cura 5.9.0 (https://ultimaker.com/ja/software/ultimaker-cura/) が生成するGコードにて正しく印刷できることを確認しています。
プログラムはWindowsPC用であり、PMC-S4とUSBポートで接続したPC上で実行して使用します。

◆要件
OS: Windows10/11
I/Oボード: PMC-S4シリーズ (PMC-S4/16/32A-U(35V))など
https://www.y2c.co.jp/
 PMC-S4はボード上のスイッチでIDを0~Fの間で設定可能ですが、IDは0に設定してください。
 ボードのIDを変更する必要がある場合は、別添のソースファイルを編集してプログラムを再ビルドしてください。

◆インストール方法
実行ファイル<bpe3dfp.exe>を実行可能なフォルダにコピーして使用します。
使用するPCにPMC-S4シリーズのドライバーをあらかじめPCにインストールする必要があります。
 PMC-S4を購入すると、Y2Corporationにドライバーソフトウェアを請求できます。

◆使用方法
3Dフードプリンターの電源を入れ、PCとUSBケーブルで接続します。
Windowsのコマンドプロンプトを開きます。
実行ファイルをコピーしたフォルダにカレントディレクトリを移動します。
 例) cd c:\program files\bpe3dfp\

Gコードを記述したファイル<sample.gcode>を引数に指定して実行します。
 例) Gコードファイルを実行ファイルと同じフォルダに置いた場合
 c:\program files\bpe3dfp>bpe3dfp1.exe sample.gcode
 例) Gコードファイルを実行ファイルと別フォルダに置いた場合
 c:\programfiles\bpe3dfp>bpe3dfp1.exe c:\user\hoge\data\sample.gcode

"Press any key to start printing"というメッセージが表示されたら、適当なキーを押すと印刷を開始します。

印刷を修了するとプログラムは自動的に終了します。

◆トラブルシューティング
次のエラーメッセージが表示された場合
"Failed to open PMC-S4/16/32A-U"
 I/Oボードを開くことができませんでした。下記について確認してください。
  ・プリンターの電源が入っているか
  ・USBケーブルが接続されているか
  ・I/OボードのIDが正しく設定されているか
  ・I/Oボードのドライバーが正しくインストールされているか

"Failed to open the G-code file"
 指定されたGコードファイルを開けませんでした。下記について確認してください。
  ・Gコードを記載したファイルが指定されたフォルダに存在するか
  ・指定したファイル名が正しいか
  ・ファイルへのアクセス権が正しく付与されているか

◆その他
このプログラムは無保証で提供されており、明示・黙示を問わず、いかなる保証も含まれておりません。特定の目的への適合性や、法的権利の侵害を行わないことの保証も含みません。 本ソフトウェアの使用に起因するデータ損失、業務停止、その他の損害について、開発者および関係者は一切責任を負いません。
連絡先: 五月女　格 (itarus@g.ecc.u-tokyo.ac.jp)